function [result] = front(x,fe,L)
%FRONT Cette fonction renvoie la liste des indices des dÃ©buts de notes, et
%fait un tracÃ© superposÃ© du signal, de son enveloppe, de ses fronts 
% x : signal Ã  analyser 
% fe : frÃ©quence d'Ã©chantillonage de ce signal 
% L : nombre de points Ã  utiliser pour la dÃ©rivÃ©e sur plusieurs points

% On se rÃ©duit Ã  un canal si le signal est stÃ©rÃ©o
x = x(:,1) ; 

% On trace le signal renormalisÃ©
[M I] = max(x) ; 
x_norm = x/M ; 
temporel(x_norm,fe,'-b')
hold on 

% Nombre de points du signal
N = length(x) ; 

% Filtrage du signal par la formule y(n) = a*y(n-1) + x(n)^2 
y = filter(1,[1 -0.99],x.*x) ; 

% TracÃ© de l'enveloppe Ã©nergÃ©tique renormalisÃ©e
env = sqrt(0.01*y) ; 
[M I] = max(env) ; 
env_norm  = env/M ; 
%temporel(env_norm(1:N),fe,'-g') ;

% On dérive le signal avec L points autour de chaque valeur : on obtient
% les fronts montants
fr =  filter([ones(1,L) ones(1,L)*(-1)],1,y) ;

% TracÃ© de la partie positive des fronts montants 
fr = max(0,fr) ; 
[M I] = max(fr);
fr_norm = fr/M ; 
temporel(fr_norm,fe,'-r') 
hold off


[peaks,locs,w,p] = findpeaks(fr_norm,fe) ; 

R = [peaks' ; locs' ; w' ; p']' ;

result = R(p> ;

end

